angular.module("anime",["ngRoute","anime.resource"]).config(["$routeProvider",function(a){a.when("/anime",{templateUrl:"anime/list.html",controller:"AnimeListCtrl",authRequired:!0})}]).controller("AnimeListCtrl",["$scope","Animes","$location","$filter","valuesService",function(a,b,c,d,e){function f(b){a.animes.splice(a.animes.indexOf(b),1)}a.animes=b.items,a.remove=function(a){a.remove().then(function(){f(a)})},a.update=function(a){e.update(a).then(function(a){a.editable=!1})},a.cancel=function(b){b.isnew&&(a.newanime={}),b.editable=!1},a.add=function(){a.newanime={isnew:!0}},a.create=function(c){b.post(c).then(function(b){a.newanime={},a.animes.push(b)},function(){console.log("Error")})},a.finished=function(a){e.finished(a)},a.increaseEp=function(a){e.increaseEp(a)},a.decreaseEp=function(a){e.decreaseEp(a)}}]),angular.module("anime.resource",["restangular"]).factory("Animes",["Restangular",function(a){var b=a.all("anime");return b.items=b.getList().$object,b}]),angular.module("14all",["ui.bootstrap","manga","movie","auth","serie","anime","14all.templates"]).config(["RestangularProvider",function(a){a.setRestangularFields({id:"_id"}),a.setBaseUrl("/api")}]).controller("AppCtrl",["$scope","authService","$store",function(a,b,c){a.isLoggedIn=b.isLoggedIn,a.logout=b.logout,a.settings=c.bind(a,"settings",{excludeFinished:!1}),a.focus={search:!0},a.$on("$routeChangeStart",function(){a.focus.search=!1}),a.$on("$routeChangeSuccess",function(){a.focus.search=!0})}]),angular.module("auth",["ngRoute"]).config(["$routeProvider",function(a){a.when("/login",{templateUrl:"auth/login.html",controller:["$scope","authService","$routeParams",function(a,b,c){c.token&&b.login(c.token),a.heading="Login",a.message="You need to login to view this page!"}]}).when("/notauthorized",{templateUrl:"auth/message.html",controller:["$scope","authService",function(a){a.heading="Not Authorized",a.message="You are not authorized to view this page!"}]}).when("/logout",{templateUrl:"auth/message.html",controller:["$scope","authService",function(a,b){a.heading="Logout",a.message="Your logout was a success!",b.logout()}]}).otherwise({templateUrl:"auth/message.html",controller:["$scope",function(a){a.heading="Welcome!",a.message="Welcome to 14all! :)"}]})}]).run(["$rootScope","authService","$location",function(a,b,c){b.authenticate().then(function(){a.$on("$routeChangeStart",function(a,d){d.$$route&&d.$$route.authRequired&&(b.isLoggedIn()||c.path("/login"))})})}]).factory("authService",["Restangular","$location","$store",function(a,b,c){function d(){return a.oneUrl("auth/info").get().then(function(a){k=a},function(){k={}})}function e(){return k&&k.user&&k.user.username}function f(){return a.setDefaultHeaders({Authorization:"Bearer "+c.get("access_token")}),d()}function g(a){c.set("access_token",a),f()}function h(a){g(a),b.url("/")}function i(){a.oneUrl("auth/logout").post().then(function(){c.remove("access_token"),k={},a.setDefaultHeaders({Authorization:""}),b.url("/")})}function j(){}var k,l={isLoggedIn:e,login:h,authenticate:f,getAuthInfo:d,logout:i,isAuthorized:j,authInfo:k};return l}]),angular.module("manga",["ngRoute","manga.resource"]).config(["$routeProvider",function(a){a.when("/manga",{templateUrl:"manga/list.html",controller:"MangaListCtrl",authRequired:!0})}]).controller("MangaListCtrl",["$scope","Mangas","$location","$filter","valuesService",function(a,b,c,d,e){function f(b){a.mangas.splice(a.mangas.indexOf(b),1)}a.mangas=b.items,a.remove=function(a){a.remove().then(function(){f(a)})},a.update=function(a){e.update(a).then(function(a){a.editable=!1})},a.cancel=function(b){b.isnew&&(a.newmanga={}),b.editable=!1},a.add=function(){a.newmanga={isnew:!0}},a.create=function(c){b.post(c).then(function(b){a.newmanga={},a.mangas.push(b)},function(){console.log("Error")})},a.finished=function(a){e.finished(a)},a.increaseCh=function(a){e.increaseCh(a)},a.decreaseCh=function(a){e.decreaseCh(a)},a.getNextChapterUrl=function(a){if(a.finished)return"";var b=a.url,c=a.chapter+1;return b?b.replace("$$chapter$$",c):""}}]),angular.module("manga.resource",["restangular"]).factory("Mangas",["Restangular",function(a){var b=a.all("manga");return b.items=b.getList().$object,b}]),angular.module("movie",["ngRoute","movie.resource"]).config(["$routeProvider",function(a){a.when("/movie",{templateUrl:"movie/list.html",controller:"MovieListCtrl",authRequired:!0})}]).controller("MovieListCtrl",["$scope","Movies","$location","$filter","valuesService",function(a,b,c,d,e){function f(b){a.movies.splice(a.movies.indexOf(b),1)}a.movies=b.items,a.remove=function(a){a.remove().then(function(){f(a)})},a.update=function(a){e.update(a).then(function(a){a.editable=!1})},a.cancel=function(b){b.isnew&&(a.newmovie={}),b.editable=!1},a.add=function(){a.newmovie={isnew:!0}},a.create=function(c){b.post(c).then(function(b){a.newmovie={},a.movies.push(b)},function(){console.log("Error")})},a.finished=function(a){e.finished(a)}}]),angular.module("movie.resource",["restangular"]).factory("Movies",["Restangular",function(a){var b=a.all("movie");return b.items=b.getList().$object,b}]),angular.module("serie",["ngRoute","serie.resource"]).config(["$routeProvider",function(a){a.when("/serie",{templateUrl:"serie/list.html",controller:"SerieListCtrl",authRequired:!0})}]).controller("SerieListCtrl",["$scope","Series","$location","$filter","valuesService",function(a,b,c,d,e){function f(b){a.series.splice(a.series.indexOf(b),1)}a.series=b.items,a.remove=function(a){a.remove().then(function(){f(a)})},a.update=function(){e.then(function(a){a.editable=!1})},a.cancel=function(b){b.isnew&&(a.newserie={}),b.editable=!1},a.add=function(){a.newserie={isnew:!0}},a.create=function(c){b.post(c).then(function(b){a.newserie={},a.series.push(b)},function(){console.log("Error")})},a.finished=function(a){e.finished(a)},a.increaseSe=function(a){e.increaseSe(a)},a.decreaseSe=function(a){e.decreaseSe(a)},a.increaseEp=function(a){e.increaseEp(a)},a.decreaseEp=function(a){e.decreaseEp(a)}}]),angular.module("serie.resource",["restangular"]).factory("Series",["Restangular",function(a){var b=a.all("serie");return b.items=b.getList().$object,b}]),angular.module("14all").directive("finishEditButton",[function(){return{template:'<div class="btn-group pull-right">     <a class="btn btn-default" ng-class="{active:model.finished}" href="" ng-click="finished()"><i class="glyphicon glyphicon-ok"></i></a>    <div class="btn-group">        <button type="button" class="btn btn-default dropdown-toggle"><i class="glyphicon glyphicon-chevron-down"></i></button>        <ul class="dropdown-menu" role="menu">            <li><a ng-model="model.editable" btn-checkbox href=""><i class="glyphicon glyphicon-pencil"></i> edit</a></li>            <li><a ng-click="remove()" href=""><i class="glyphicon glyphicon-trash"></i> delete</a></li>        </ul>    </div></div>',restrict:"E",scope:{model:"=model",finished:"&finished",remove:"&remove"},link:function(){}}}]),angular.module("14all").directive("focusMe",["$timeout","$parse",function(a,b){return{link:function(c,d,e){var f=b(e.focusMe);c.$watch(f,function(b){b===!0&&a(function(){d[0].focus()})}),d.bind("blur",function(){})}}}]),angular.module("14all").config(["$httpProvider",function(a){a.interceptors.push("loadingHttpInterceptor")}]).factory("loadingHttpInterceptor",["$q","$rootScope","$injector",function(a,b,c){return b.loading=!1,b.http=null,{request:function(c){return b.loading=!0,c||a.when(c)},requestError:function(d){return b.http=b.http||c.get("$http"),b.http.pendingRequests.length<1&&(b.loading=!1),canRecover(d)?responseOrNewPromise:a.reject(d)},response:function(d){return b.http=b.http||c.get("$http"),b.http.pendingRequests.length<1&&(b.loading=!1),d||a.when(d)},responseError:function(d){return b.http=b.http||c.get("$http"),b.http.pendingRequests.length<1&&(b.loading=!1),canRecover(d)?responseOrNewPromise:a.reject(d)}}}]).directive("loading",["$rootScope",function(a){return{restrict:"E",template:'<div class="" ng-show="loading"><div id="floatingCirclesG" class="absolute-center"><div class="f_circleG" id="frotateG_01"></div><div class="f_circleG" id="frotateG_02"></div><div class="f_circleG" id="frotateG_03"></div><div class="f_circleG" id="frotateG_04"></div><div class="f_circleG" id="frotateG_05"></div><div class="f_circleG" id="frotateG_06"></div><div class="f_circleG" id="frotateG_07"></div><div class="f_circleG" id="frotateG_08"></div></div></div></div>',scope:!0,link:function(b){a.$watch("loading",function(a){b.loading!==a&&(b.loading=a)})}}}]),angular.module("14all").directive("saveCancelButton",[function(){return{template:'<div class="btn-group btn-group-justified">                 <a class="btn btn-default" ng-click="save()">save</a>                 <a class="btn btn-default" ng-click="cancel()">cancel</a>             </div>',restrict:"E",scope:{save:"&save",cancel:"&cancel"},link:function(){}}}]),angular.module("14all").directive("upDownButton",[function(){return{template:'<div class="input-group">                 <a href="" ng-click="decrease()" class="btn btn-default input-group-btn" ng-disabled="disabled"><i class="glyphicon glyphicon-minus"></i></a>                 <div class="middle-vertical text-right">{{value}}</div>                 <a href="" ng-click="increase()" class="btn btn-default input-group-btn" ng-disabled="disabled"><i class="glyphicon glyphicon-plus"></i></a>             </div>',restrict:"E",scope:{decrease:"&decrease",increase:"&increase",value:"=value",disabled:"=disabled"},link:function(){}}}]),angular.module("14all").filter("isFinished",function(){return function(a,b){if(!b)return a;var c=[];return angular.forEach(a,function(a){(angular.isUndefined(a.finished)||!a.finished)&&c.push(a)}),c}}),angular.module("14all").factory("settingsService",["$rootScope","$store",function(){var a={};return a}]),angular.module("14all").factory("$store",["$parse",function(a){var b="undefined"==typeof window.localStorage?void 0:window.localStorage,c=!("undefined"==typeof b||"undefined"==typeof window.JSON),d={parseValue:function(a){var b;try{b=JSON.parse(a),"undefined"==typeof b&&(b=a),"true"==b&&(b=!0),"false"==b&&(b=!1),parseFloat(b)!=b||angular.isObject(b)||(b=parseFloat(b))}catch(c){b=a}return b}},e={set:function(a,e){if(!c)try{return $.cookie(a,e),e}catch(f){console.log("Local Storage not supported, make sure you have the $.cookie supported.")}var g=JSON.stringify(e);return b.setItem(a,g),d.parseValue(g)},get:function(a){if(!c)try{return d.parseValue($.cookie(a))}catch(e){return null}var f=b.getItem(a);return d.parseValue(f)},remove:function(a){if(!c)try{return $.cookie(a,null),!0}catch(d){return!1}return b.removeItem(a),!0},bind:function(b,c,d){return d=d||"",e.get(c)||e.set(c,d),a(c).assign(b,e.get(c)),b.$watch(c,function(a){e.set(c,a)},!0),e.get(c)}};return e}]),angular.module("14all").factory("valuesService",[function(){function a(a){return a.finished=!a.finished,b(a)}function b(a){return a.put().then(function(b){return a.updatedAt=b.updatedAt,a})}function c(a){return a+=1}function d(a){return 0>=a?a=0:a-=1,a}function e(a){var d=a.episode;return a.episode=c(a.episode),d!==a.episode?b(a):void 0}function f(a){var c=a.episode;return a.episode=d(a.episode),c!==a.episode?b(a):void 0}function g(a){var d=a.chapter;return a.chapter=c(a.chapter),d!==a.chapter?b(a):void 0}function h(a){var c=a.chapter;return a.chapter=d(a.chapter),c!==a.chapter?b(a):void 0}function i(a){var d=a.season;return a.season=c(a.season),d!==a.season?b(a):void 0}function j(a){var c=a.season;return a.season=d(a.season),c!==a.season?b(a):void 0}var k={increase:c,decrease:d,increaseEp:e,decreaseEp:f,increaseCh:g,decreaseCh:h,increaseSe:i,decreaseSe:j,update:b,finished:a};return k}]);